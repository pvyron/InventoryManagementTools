@page "/file/share"
@using InMa.Shopping.Data.Repositories.Abstractions
@using InMa.Shopping.Data.Repositories.Implementations
@using Microsoft.AspNetCore.Authorization
@using InMa.Shopping.Components.FileSharing.Shared
@rendermode InteractiveServer
@attribute [Authorize]

<PageTitle>File-sharing</PageTitle>

<FluentInputFile @ref="@myFileByStream"
                 AnchorId="MyUploadStream"
                 DragDropZoneVisible="false"
                 Mode="InputFileMode.Stream"
                 Multiple="true"
                 MaximumFileSize="@(_maxFileSizeInBytes)"
                 @* Accept=".mp4, .mov, .avi" *@
                 @* OnFileUploaded="@OnFileUploadedAsync" *@
                 @* OnCompleted="@OnCompleted" *@
                 OnInputFileChange="@OnFilesSelectedAsync"/>

<FluentProgress Min="0" Max="browserFiles.Length" Value="@progressPercent" Visible="@(progressPercent > 0)" />
<FluentLabel Alignment="HorizontalAlignment.Center">
    @progressTitle
</FluentLabel>

<FluentButton Appearance="Appearance.Accent" Id="MyUploadStream">
    Choose files
</FluentButton>

@if (browserFiles.Any())
{
    <h4>File(s) to upload:</h4>
    <ul>
        @foreach (var (file, fileIndex) in browserFiles)
        {
            <li>
                <DigitalItemProperties DigitalItem="@file" />
            </li>
        }
    </ul>
}

<FluentButton Appearance="Appearance.Accent" OnClick="@UploadAllButtonClicked">
    Upload files
</FluentButton>